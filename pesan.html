<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hibualamo Ojek - Pesan Sekarang</title>
    <meta name="description" content="Pesan ojek, antar makanan, atau ambil barang dengan mudah di Hibualamo Ojek.">
    
    <!-- Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#10a9c4',
                        'primary-hover': '#0d8ca3',
                        success: '#27ae60',
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-orange-50 min-h-screen flex items-center justify-center p-4">
<div class="bg-white rounded-3xl shadow-2xl max-w-lg w-full overflow-hidden">
    <!-- Header -->
    <header class="bg-gradient-to-r from-primary to-primary-hover text-white text-center py-10 px-8">
        <h1 class="text-4xl font-bold mb-2">Hibualamo Ojek</h1>
        <a href="ongkir.html" class="block text-red-400 font-semibold text-lg hover:underline mb-3">
            Cek Ongkir Wilayah
        </a>
        <p class="font-mono text-lg opacity-90">Pesan Ojek â€¢ Antar Makanan â€¢ Ambil Barang</p>
    </header>

    <!-- Main Form -->
    <main class="p-8">
        <h3 class="font-mono text-3xl font-bold text-blue-500/100 text-center mb-8">Buat Pesanan Baru</h3>

        <div id="info-auto" class="hidden bg-blue-100 border-l-4 border-primary text-blue-800 p-4 rounded-lg mb-6 text-center font-medium">
            Detail pesanan sudah otomatis terisi dari menu yang Anda pilih!
        </div>

        <div id="error-message" class="hidden text-red-600 text-center font-semibold mb-6"></div>

        <form id="form-pesanan" class="space-y-7">
            <!-- Tipe Pesanan -->
            <div>
                <label for="tipe-pesanan" class="block text-gray-800 font-bold mb-2">
                    Tipe Pesanan <span class="text-red-500">*</span>
                </label>
                <select id="tipe-pesanan" required
                        class="w-full px-5 py-4 border-2 border-gray-300 rounded-xl focus:border-primary focus:ring-4 focus:ring-primary/30 transition">
                    <option value="">-- Pilih Tipe Pesanan --</option>
                    <option value="Ambil Barang">Ambil Barang</option>
                    <option value="Makanan/Minuman">Makanan/Minuman</option>
                    <option value="Ojek (Antar Jemput Orang)">Ojek (Antar Jemput Orang)</option>
                </select>
            </div>

            <!-- Nama Pelanggan -->
            <div>
                <label for="nama" class="block text-gray-800 font-bold mb-2">
                    Nama Pelanggan <span class="text-red-500">*</span>
                </label>
                <input type="text" id="nama" placeholder="Contoh: Brahim Diaz" required
                       class="w-full px-5 py-4 border-2 border-gray-300 rounded-xl focus:border-primary focus:ring-4 focus:ring-primary/30 transition">
            </div>

            <!-- Detail Pesanan -->
            <div>
                <label for="pesanan" class="block text-gray-800 font-bold mb-2">
                    Detail Pesanan / Barang <span class="text-red-500">*</span>
                </label>
                <textarea id="pesanan" rows="6" placeholder="Detail pesanan Anda..." required
                          class="w-full px-5 py-4 border-2 border-gray-300 rounded-xl focus:border-primary focus:ring-4 focus:ring-primary/30 transition resize-none"></textarea>
            </div>

            <!-- Alamat Pickup -->
            <div>
                <label for="pickup" class="block text-gray-800 font-bold mb-2">
                    Alamat Pickup <span class="text-red-500">*</span>
                </label>
                <input type="text" id="pickup" placeholder="Contoh: Jl. Trans Halut No. 12" required
                       class="w-full px-5 py-4 border-2 border-gray-300 rounded-xl focus:border-primary focus:ring-4 focus:ring-primary/30 transition">
            </div>

            <!-- Alamat Tujuan -->
            <div>
                <label for="tujuan" class="block text-gray-800 font-bold mb-2">
                    Alamat Tujuan
                </label>
                <input type="text" id="tujuan" placeholder="Antar ke mana?"
                       class="w-full px-5 py-4 border-2 border-gray-300 rounded-xl focus:border-primary focus:ring-4 focus:ring-primary/30 transition">
            </div>

            <!-- Submit Button -->
            <button type="submit" id="submit-btn"
                    class="w-full bg-primary hover:bg-primary-hover text-white font-bold text-xl py-5 rounded-xl shadow-lg transition transform hover:scale-105 font-mono">
                Kirim Pesanan
            </button>
        </form>
    </main>
</div>

<script>
// Auto-fill dan auto-select saat halaman dimuat
document.addEventListener('DOMContentLoaded', () => {
    const urlParams = new URLSearchParams(window.location.search);
    const infoAuto = document.getElementById('info-auto');
    const tipeSelect = document.getElementById('tipe-pesanan');

    // Prioritas 1: Gunakan tipe dari URL (dari dashboard atau link langsung)
    if (urlParams.has('tipe')) {
        const tipeFromUrl = decodeURIComponent(urlParams.get('tipe'));
        if (['Ambil Barang', 'Makanan/Minuman', 'Ojek (Antar Jemput Orang)'].includes(tipeFromUrl)) {
            tipeSelect.value = tipeFromUrl;
        }
    }
    // Prioritas 2: Jika ada pesanan (dari merchant), default ke Makanan/Minuman
    else if (urlParams.has('pesanan')) {
        tipeSelect.value = 'Makanan/Minuman';
    }

    // Auto-fill detail pesanan
    if (urlParams.has('pesanan')) {
        document.getElementById('pesanan').value = decodeURIComponent(urlParams.get('pesanan'));
        infoAuto.classList.remove('hidden');
    }

    // Auto-fill alamat pickup
    if (urlParams.has('pickup')) {
        document.getElementById('pickup').value = decodeURIComponent(urlParams.get('pickup'));
    }
});

// Proses submit
document.getElementById('form-pesanan').addEventListener('submit', function(e) {
    e.preventDefault();

    const errorDiv = document.getElementById('error-message');
    const submitBtn = document.getElementById('submit-btn');
    errorDiv.classList.add('hidden');
    errorDiv.textContent = '';

    const tipe = document.getElementById('tipe-pesanan').value.trim();
    const nama = document.getElementById('nama').value.trim();
    const pesanan = document.getElementById('pesanan').value.trim();
    const pickup = document.getElementById('pickup').value.trim();
    const tujuan = document.getElementById('tujuan').value.trim();

    if (!tipe || !nama || !pesanan || !pickup) {
        errorDiv.textContent = 'âŒ Mohon lengkapi semua kolom yang wajib diisi!';
        errorDiv.classList.remove('hidden');
        return;
    }

    submitBtn.disabled = true;
    submitBtn.innerHTML = 'ðŸ“¤ Sedang mengirim...';

    const alamatTujuan = tujuan || 'Sama dengan alamat pickup';

    const ongkirInfo = `
*Biaya Ongkir :*
- Wilayah 1: Rp 10.000
- Wilayah 2: Rp 15.000
- Wilayah 3: Rp 20.000

Driver akan konfirmasi ongkir sesuai alamat tujuan.`;

    const pesan = `
*PESANAN BARU - HIBUALAMO OJEK*

*Tipe Pesanan:* ${tipe}
*Nama Pelanggan:* ${nama}

*Detail Pesanan:*
${pesanan}

*Alamat Pickup:* ${pickup}
*Alamat Tujuan:* ${alamatTujuan}

${ongkirInfo}

Mohon segera diproses ya, terima kasih!
    `.trim();

    const encoded = encodeURIComponent(pesan);
    const noAdmin = '6282379631626'; // Ganti jika perlu
    const waLink = `https://wa.me/${noAdmin}?text=${encoded}`;

    window.location.href = waLink;

    // Reset setelah kirim
    setTimeout(() => {
        this.reset();
        submitBtn.disabled = false;
        submitBtn.innerHTML = 'ðŸ“¤ Kirim Pesanan via WhatsApp';

        // Kembalikan auto-fill
        const urlParams = new URLSearchParams(window.location.search);
        if (urlParams.has('pesanan')) {
            document.getElementById('pesanan').value = decodeURIComponent(urlParams.get('pesanan'));
        }
        if (urlParams.has('pickup')) {
            document.getElementById('pickup').value = decodeURIComponent(urlParams.get('pickup'));
        }
        if (urlParams.has('tipe')) {
            document.getElementById('tipe-pesanan').value = decodeURIComponent(urlParams.get('tipe'));
        } else if (urlParams.has('pesanan')) {
            document.getElementById('tipe-pesanan').value = 'Makanan/Minuman';
        }
    }, 1000);
});
</script>
</body>
</html>
